# riskmetric

`riskmetric` is a collection of risk metrics to evaluate the quality of
R packages.

> \[!IMPORTANT\]
>
> Lifecycle: **Maintenance Only**
>
> The *R Validation Hub* is shifting development efforts to our new
> flagship assessment tool,
> [`{val.meter}`](https://github.com/pharmaR/val.meter). While
> development is not ending for
> [riskmetric](https://pharmar.github.io/riskmetric/), it has shifted to
> maintenance-only. Please continue to file bug reports for erroneous
> behaviors, but for feature requests and discussion on approach, please
> head over to `{val.meter}`.

## Background

The risk of using an R package is evaluated based on a number of metrics
meant to evaluate development best practices, code documentation,
community engagement and development sustainability. We hope to provide
a framework to quantify risk by assessing these metrics. This package
serves as a starting point for exploring the heterogeneity of code
quality, and begin a broader conversation about the validation of R
packages. Primarily, this effort aims to provide some context for
validation within regulated industries.

We separate three steps in the workflow to assess the risk of an R
package using `riskmetric`:

1.  **Finding a source for package information (installed package or
    CRAN/git source)** [`pkg_ref()`](reference/pkg_ref.md)
2.  **Assessing the package under validation criteria**
    [`pkg_assess()`](reference/pkg_assess.md)
3.  **Scoring assessment criteria**
    [`pkg_score()`](reference/pkg_score.md)

The results will be assembled in a dataset of validation criteria
containing an overall risk score for each package as shown in the
example below.

## Installation

You can install `riskmetric` from CRAN with:

``` r
install.packages("riskmetric")
```

Or from GitHub using `devtools` with:

``` r
devtools::install_github("pharmaR/riskmetric")
```

## Example

Scrape metadata locally or remotely, then assess that metadata and score
it to estimate risk. For each package, derive a composite measure of
risk, or a collection of individual scores which can be easily used to
generate validation reports.

``` r
library(dplyr)
library(riskmetric)

pkg_ref(c("riskmetric", "utils", "tools")) %>%
  pkg_assess() %>%
  pkg_score()
```

## The `{riskassessment}` application [![](reference/figures/hex-riskassessment-aspconfig.png)](https://pharmar.github.io/riskassessment/)

`riskassessment` is a full-fledged R package containing a shiny
front-end that augments the utility of `riskmetric`. The applicationâ€™s
goal is to provide a central hub for an organization to review and
assess the risk of R packages, providing handy tools and guide rails
along the way. The app uses a local database to store & display:

- all `riskmetric` metrics, including package risk scores over time
- organization-wide metric weighting, plus rules to automate org
  decisions (whether to endorse/ prohibit the pkg)
- package-level user dialogue on the perceived risk, to facilitate
  communication & notes

To learn more about `riskassessment`, please browse the [user
guide](https://pharmar.github.io/riskassessment/) or consider taking the
[demo app](https://rinpharma.shinyapps.io/risk_assessment) for a spin.

## Get Involved

We have a bi-weekly sprint meeting for developers to discuss the
progress.

- Contact `eric.milliman@biogen.com` to be added to the meeting.
- [Project Planning Meeting
  Structure](https://github.com/pharmaR/riskmetric/issues/57)
- [Milestone](https://github.com/pharmaR/riskmetric/milestones)

`riskmetric` is centrally a community project. Comfort with a
quantification of risk comes via consensus, and for that this project is
dependent on close community engagement. There are plenty of ways to
help:

- Share the package
- File [issues](https://github.com/pharmaR/riskmetric/issues) when you
  encounter bugs
- Weigh in on proposed metrics, or [suggest a new
  one](https://github.com/pharmaR/riskmetric/issues/new?labels=Metric%20Proposal)
- Help us devise the best way to summarize risk into a single score
- Help us keep documentation up to date
- Contribute code to tackle the metric backlog

# Package index

## Package Reference

Create Package Reference for Each Package Risk Metric and Cache Metadata

- [`pkg_ref()`](pkg_ref.md) [`pkg_install()`](pkg_ref.md)
  [`pkg_source()`](pkg_ref.md) [`pkg_cran()`](pkg_ref.md)
  [`pkg_bioc()`](pkg_ref.md) [`pkg_missing()`](pkg_ref.md)
  [`pkg_library()`](pkg_ref.md) [`as_pkg_ref()`](pkg_ref.md) : Create a
  package reference
- [`pkg_ref_class_hierarchy`](pkg_ref_class_hierarchy.md) : The
  \`pkg_ref\` subclass hierarchy, used for pkg_ref object creation with
  a specified subclass
- [`pkg_ref_cache`](riskmetric_metadata_caching.md) : S3 generic to
  calculate a \`pkg_ref\` field

## Package Assessment

Assess Package Metadata against a risk criterion

- [`pkg_assess()`](pkg_assess.md) : Apply assess\_\* family of functions
  to a package reference
- [`all_assessments()`](all_assessments.md) : A default list of
  assessments to perform for each package
- [`get_assessments()`](get_assessments.md) : Get a specific set of
  assess\_\* functions for pkg_assess
- [`assess_covr_coverage()`](assess_covr_coverage.md) : Assess a package
  code coverage using the \`covr\` package
- [`assess_dependencies()`](assess_dependencies.md) : Assessment of
  dependency footprint for a specific package
- [`assess_downloads_1yr()`](assess_downloads_1yr.md) : Assess a package
  for the number of downloads in the past year
- [`assess_export_help()`](assess_export_help.md) : Assess a package for
  availability of documentation for exported values
- [`assess_exported_namespace()`](assess_exported_namespace.md) : Assess
  a package's results from running R CMD check
- [`assess_has_bug_reports_url()`](assess_has_bug_reports_url.md) :
  Assess a package for the presence of a url field where bugs can be
  reported.
- [`assess_has_examples()`](assess_has_examples.md) : Assess a package
  for the presence of example or usage fields in function documentation
- [`assess_has_maintainer()`](assess_has_maintainer.md) : Assess a
  package for an associated maintainer
- [`assess_has_news()`](assess_has_news.md) : Assess a package for the
  presence of a NEWS file
- [`assess_has_source_control()`](assess_has_source_control.md) : Assess
  a package for an associated source control url
- [`assess_has_vignettes()`](assess_has_vignettes.md) : Assess a package
  for the presence of Vignettes files
- [`assess_has_website()`](assess_has_website.md) : Assess a package for
  an associated website url
- [`assess_last_30_bugs_status()`](assess_last_30_bugs_status.md) :
  Assess how many recent BugReports have been closed
- [`assess_license()`](assess_license.md) : Assess a package for an
  acceptable license
- [`assess_news_current()`](assess_news_current.md) : Assess a package
  for an up-to-date NEWS file
- [`assess_r_cmd_check()`](assess_r_cmd_check.md) : Assess a package's
  results from running R CMD check
- [`assess_remote_checks()`](assess_remote_checks.md) : Assess package
  checks from CRAN/Bioc or R CMD check
- [`assess_reverse_dependencies()`](assess_reverse_dependencies.md) :
  Generate list of Reverse Dependencies for a package
- [`assess_size_codebase()`](assess_size_codebase.md) : Assess a package
  for size of code base
- [`assessment_error_as_warning()`](assessment_error_as_warning.md) :
  Error handler for assessments to deescalate errors to warnings
- [`assessment_error_empty()`](assessment_error_empty.md) : Error
  handler for assessments with safe fallback
- [`assessment_error_throw()`](assessment_error_throw.md) : Error
  handler for assessments to throw error immediately

## Package Risk Score

Provide Risk Score based on Risk Metrics

- [`pkg_score()`](pkg_score.md) : Score a package assessment, collapsing
  results into a single numeric
- [`pkg_metric()`](pkg_metric.md) : A helper for structuring assessment
  return objects for dispatch with the score function
- [`metric_score()`](metric_score.md) : Score a package metric
- [`metric_score(`*`<pkg_metric_covr_coverage>`*`)`](metric_score.pkg_metric_covr_coverage.md)
  : Score a package for unit test coverage
- [`metric_score(`*`<pkg_metric_dependencies>`*`)`](metric_score.pkg_metric_dependencies.md)
  : Score a package for dependencies
- [`metric_score(`*`<pkg_metric_downloads_1yr>`*`)`](metric_score.pkg_metric_downloads_1yr.md)
  : Defining an Assessment Scoring Function
- [`metric_score(`*`<pkg_metric_export_help>`*`)`](metric_score.pkg_metric_export_help.md)
  : Score a package for availability of documentation for exported
  values
- [`metric_score(`*`<pkg_metric_exported_namespace>`*`)`](metric_score.pkg_metric_exported_namespace.md)
  : Score a package for the number of exported objects
- [`metric_score(`*`<pkg_metric_has_bug_reports_url>`*`)`](metric_score.pkg_metric_has_bug_reports_url.md)
  : Score a package for the presence of a bug report url
- [`metric_score(`*`<pkg_metric_has_examples>`*`)`](metric_score.pkg_metric_has_examples.md)
  : Score a package for the presence of a example or usage fields
- [`metric_score(`*`<pkg_metric_has_maintainer>`*`)`](metric_score.pkg_metric_has_maintainer.md)
  : Score a package for inclusion of an associated maintainer
- [`metric_score(`*`<pkg_metric_has_news>`*`)`](metric_score.pkg_metric_has_news.md)
  : Score a package for the presence of a NEWS file
- [`metric_score(`*`<pkg_metric_has_source_control>`*`)`](metric_score.pkg_metric_has_source_control.md)
  : Score a package for inclusion of an associated source control url
- [`metric_score(`*`<pkg_metric_has_vignettes>`*`)`](metric_score.pkg_metric_has_vignettes.md)
  : Score a package for the presence of a Vignettes file
- [`metric_score(`*`<pkg_metric_has_website>`*`)`](metric_score.pkg_metric_has_website.md)
  : Score a package for inclusion of an associated website url
- [`metric_score(`*`<pkg_metric_last_30_bugs_status>`*`)`](metric_score.pkg_metric_last_30_bugs_status.md)
  : Score a package for number of recently opened BugReports that are
  now closed
- [`metric_score(`*`<pkg_metric_license>`*`)`](metric_score.pkg_metric_license.md)
  : Score a package for acceptable license
- [`metric_score(`*`<pkg_metric_news_current>`*`)`](metric_score.pkg_metric_news_current.md)
  : Score a package for NEWS files updated to current version
- [`metric_score(`*`<pkg_metric_r_cmd_check>`*`)`](metric_score.pkg_metric_r_cmd_check.md)
  : Score a package based on R CMD check results run locally
- [`metric_score(`*`<pkg_metric_remote_checks>`*`)`](metric_score.pkg_metric_remote_checks.md)
  : Score a package based on R CMD check results run by BioC or CRAN
- [`metric_score(`*`<pkg_metric_reverse_dependencies>`*`)`](metric_score.pkg_metric_reverse_dependencies.md)
  : Scoring method for number of reverse dependencies a package has
- [`metric_score(`*`<pkg_metric_size_codebase>`*`)`](metric_score.pkg_metric_size_codebase.md)
  : Score a package for number of lines of code

## Package Risk Summary

Summarizing across metric scores

- [`summarize_scores()`](summarize_scores.md) : Summarize a default set
  of assessments into a single risk score

## Metric Error Handler

Error handler functions

- [`assessment_error_as_warning()`](assessment_error_as_warning.md) :
  Error handler for assessments to deescalate errors to warnings
- [`assessment_error_empty()`](assessment_error_empty.md) : Error
  handler for assessments with safe fallback
- [`assessment_error_throw()`](assessment_error_throw.md) : Error
  handler for assessments to throw error immediately
- [`score_error_NA()`](score_error_NA.md) : Score error handler to
  silently return NA
- [`score_error_default()`](score_error_default.md) : Default score
  error handling, emitting a warning and returning 0
- [`score_error_zero()`](score_error_zero.md) : Score error handler to
  silently return 0

## Utilities

Utility functions

- [`as_pkg_metric()`](as_pkg_metric.md) :

  Convert an object to a `pkg_metric`

- [`pkg_ref()`](pkg_ref.md) [`pkg_install()`](pkg_ref.md)
  [`pkg_source()`](pkg_ref.md) [`pkg_cran()`](pkg_ref.md)
  [`pkg_bioc()`](pkg_ref.md) [`pkg_missing()`](pkg_ref.md)
  [`pkg_library()`](pkg_ref.md) [`as_pkg_ref()`](pkg_ref.md) : Create a
  package reference

# Articles

### All vignettes

- [Extending riskmetric](extending-riskmetric.md):
- [Get Started](riskmetric.md):
